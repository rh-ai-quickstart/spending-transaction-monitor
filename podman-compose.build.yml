services:
  # PostgreSQL Database - Build Override
  migrations:
    image: spending-monitor-db:local  # Override quay image with local tag
    build:
      context: .
      dockerfile: packages/db/Containerfile
      args:
        TORCH_VARIANT: cpu  # Use CPU version for local builds (smaller, faster)

  # FastAPI Backend - Build Override
  api:
    image: spending-monitor-api:local  # Override quay image with local tag
    build:
      context: .
      dockerfile: packages/api/Containerfile
      args:
        TORCH_VARIANT: cpu  # Use CPU version for local builds (smaller, faster)
        BASE_IMAGE: python:3.12-slim  # Use slim image for faster local builds (UBI also works with subscription fix)

  # React Frontend - Build Override
  # Environment variables are now injected at runtime, not build time
  ui:
    image: spending-monitor-ui:local  # Override quay image with local tag
    build:
      context: .
      dockerfile: packages/ui/Containerfile


  
