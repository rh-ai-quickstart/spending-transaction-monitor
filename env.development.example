# Spending Transaction Monitor - Development Environment Configuration
# Copy this file to .env.development and update the values for local development

# =============================================================================
# Database Configuration
# =============================================================================
POSTGRES_DB=spending-monitor
POSTGRES_USER=user
POSTGRES_PASSWORD=password
DB_PORT=5432
DATABASE_URL=postgresql+asyncpg://user:password@postgres:5432/spending-monitor

# =============================================================================
# API Configuration
# =============================================================================
API_PORT=8000
ENVIRONMENT=development
BYPASS_AUTH=false
DEBUG=true

# =============================================================================
# CORS Configuration
# =============================================================================
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
ALLOWED_HOSTS='["http://localhost:3000"]'

# =============================================================================
# LLM Configuration (Required for AI features)
# =============================================================================
LLM_PROVIDER=openai
BASE_URL=https://api.openai.com/v1
API_KEY=your-openai-api-key-here
MODEL=gpt-3.5-turbo
NODE_ENV=development

# =============================================================================
# Embedding Configuration (for category normalization)
# =============================================================================
# Uses local sentence-transformers by default - no external services required!
EMBEDDING_PROVIDER=local
EMBEDDING_MODEL=all-minilm
EMBEDDING_DIMENSIONS=384
# OLLAMA_BASE_URL=http://localhost:11434  # Only needed if using ollama provider (deprecated)

# =============================================================================
# Keycloak Authentication Configuration
# =============================================================================
# KEYCLOAK_URL: Internal URL for API to reach Keycloak (via container network)
# - Used by API for JWKS, userinfo, and other internal endpoints
# - Uses container service name for fast internal communication
KEYCLOAK_URL=http://spending-monitor-keycloak:8080

# KEYCLOAK_FRONTEND_URL: External URL where browser accesses Keycloak
# - Used for token issuer validation, authorization, and browser redirects
# - Must match the URL the browser uses to access Keycloak
# - Tokens are issued with this URL as the issuer
# - Also used as KC_FRONTEND_URL by Keycloak container itself
KEYCLOAK_FRONTEND_URL=http://localhost:8080

KEYCLOAK_REALM=spending-monitor
KEYCLOAK_CLIENT_ID=spending-monitor

# Keycloak Admin Configuration
# KEYCLOAK_ADMIN and KEYCLOAK_ADMIN_PASSWORD are Keycloak's native admin variables
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=admin
KEYCLOAK_DEFAULT_PASSWORD=password123

# Keycloak Container Runtime Configuration (KC_* variables)
# These configure how the Keycloak container runs
KC_HTTP_PORT=8080
KC_HOSTNAME_STRICT=false
KC_HOSTNAME_STRICT_HTTPS=false
KC_HTTP_ENABLED=true
KC_HEALTH_ENABLED=true
KC_HOSTNAME=localhost
KC_HOSTNAME_PORT=8080
KC_HOSTNAME_URL=http://localhost:8080
# Note: KC_FRONTEND_URL is set from KEYCLOAK_FRONTEND_URL above

# Keycloak Client Configuration
# Note: These should match KEYCLOAK_FRONTEND_URL and your UI URL
KEYCLOAK_REDIRECT_URIS=http://localhost:3000/*
# KEYCLOAK_REDIRECT_URIS=https://app.your-domain.com/*,https://app.your-domain.com
KEYCLOAK_WEB_ORIGINS=http://localhost:3000

# Keycloak Database Configuration (for Helm deployment)
KEYCLOAK_DB_USER=keycloak
KEYCLOAK_DB_PASSWORD=keycloak

# =============================================================================
# SMTP Configuration (for email notifications)
# =============================================================================
# Using smtp4dev for local development (no auth required)
SMTP_HOST=smtp4dev
SMTP_PORT=25
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=spending-monitor@localhost
SMTP_USE_TLS=false
SMTP_USE_SSL=false

# =============================================================================
# UI Configuration
# =============================================================================
VITE_API_BASE_URL=/api
VITE_BYPASS_AUTH=false
VITE_ENVIRONMENT=development
# Note: VITE_KEYCLOAK_URL is set from KEYCLOAK_FRONTEND_URL in deployment

# =============================================================================
# LlamaStack Configuration (Optional - for local LLM)
# =============================================================================
LLAMASTACK_BASE_URL=http://llamastack:8321

# =============================================================================
# Development Notes
# =============================================================================
# Two-URL Keycloak Setup:
# 
# KEYCLOAK_URL (Internal):
#   - Used by API container to reach Keycloak
#   - Uses container network (fast, no port mapping needed)
#   - Format: http://spending-monitor-keycloak:8080
#
# KEYCLOAK_FRONTEND_URL (External):
#   - Used by browser to access Keycloak
#   - Used for token issuer validation
#   - Format: http://localhost:8080
#
# This separation allows:
# ✅ Fast internal API communication via container network
# ✅ Browser access via localhost
# ✅ Consistent token issuer validation
# ✅ No need for extra_hosts or DNS hacks

